{{ if eq .chezmoi.os "linux" -}}
#!/bin/bash
set -euo pipefail

echo "Installing packages via apt..."
sudo apt update
sudo apt install -y \
    zsh \
    fzf \
    direnv \
    curl \
    git \
    build-essential

# Install zoxide (not in default Ubuntu repos, use install script)
if ! command -v zoxide >/dev/null 2>&1; then
    curl -sSfL https://raw.githubusercontent.com/ajeetdsouza/zoxide/main/install.sh | sh
fi

# Install mise
if ! command -v mise >/dev/null 2>&1; then
    curl https://mise.run | sh
fi

{{ else if eq .chezmoi.os "darwin" -}}
#!/bin/bash
set -euo pipefail

# Install Homebrew if not present
if ! command -v brew >/dev/null 2>&1; then
    echo "Installing Homebrew..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    eval "$(/opt/homebrew/bin/brew shellenv)"
fi

echo "Installing packages via brew..."
brew install \
    zsh \
    fzf \
    zoxide \
    direnv \
    mise \
    starship

{{ end -}}
